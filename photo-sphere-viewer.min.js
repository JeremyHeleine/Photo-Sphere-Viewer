var PhotoSphereViewer=function(e){var t=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},n=function(){var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl"))},o=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},i=function(e,t,n){return Math.max(t,Math.min(n,e))},r=function(e,t,n,o){var i=n-e,r=o-t;return i*i+r*r},a=function(e,t){return t=void 0!==t?!!t:!1,t&&e==2*Math.PI?2*Math.PI:e-2*Math.floor(e/(2*Math.PI))*Math.PI};this.load=function(){if(bt.innerHTML="",Wt&&1===Wt.nodeType)bt.appendChild(Wt);else if(Wt&&"string"==typeof Wt)bt.innerHTML=Wt;else if(Xt){var e=document.createElement("img");e.setAttribute("src",Xt),e.setAttribute("alt",Dt),bt.appendChild(e)}else bt.textContent=Dt;return Ct=document.createElement("div"),Ct.style.width="100%",Ct.style.height="100%",Ct.style.position="relative",Ct.style.overflow="hidden",t()?void 0===window.THREE?void console.log("PhotoSphereViewer: Three.js is not loaded."):(yt={width:0,height:0,ratio:0},void(Lt&&!_t.match(/^data:image\/[a-z]+;base64/)?d():c())):void(bt.textContent="Canvas is not supported, update your browser!")};var s=function(e,t){var n=e.indexOf("GPano:"+t)+t.length+8,o=e.indexOf('"',n);return e.substring(n,o)},l=function(e,t){var n=e.indexOf("<GPano:"+t+">")+t.length+8,o=e.indexOf("</GPano:"+t+">");return e.substring(n,o)},d=function(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window.ActiveXObject)return void(bt.textContent="XHR is not supported, update your browser!");try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}}e.onreadystatechange=function(){var t,n,o,i,r,a;if(4==e.readyState&&200==e.status){var d=e.responseText,u=d.indexOf("<x:xmpmeta"),h=d.indexOf("</x:xmpmeta>"),p=d.substring(u,h);if(-1==u||-1==h||-1==p.indexOf("GPano:"))return void c(!1);t=s(p,"FullPanoWidthPixels"),t=isNaN(t)?l(p,"FullPanoWidthPixels"):t,n=s(p,"FullPanoHeightPixels"),n=isNaN(n)?l(p,"FullPanoHeightPixels"):n,o=s(p,"CroppedAreaImageWidthPixels"),o=isNaN(o)?l(p,"CroppedAreaImageWidthPixels"):o,i=s(p,"CroppedAreaImageHeightPixels"),i=isNaN(i)?l(p,"CroppedAreaImageHeightPixels"):i,r=s(p,"CroppedAreaLeftPixels"),r=isNaN(r)?l(p,"CroppedAreaLeftPixels"):r,a=s(p,"CroppedAreaTopPixels"),a=isNaN(a)?l(p,"CroppedAreaTopPixels"):a,Nt={full_width:parseInt(t),full_height:parseInt(n),cropped_width:parseInt(o),cropped_height:parseInt(i),cropped_x:parseInt(r),cropped_y:parseInt(a)},c()}},e.open("GET",_t,!0),e.send(null)},c=function(){var t=new Image;t.onload=function(){var e={full_width:t.width,full_height:t.height,cropped_width:t.width,cropped_height:t.height,cropped_x:null,cropped_y:null};for(attr in Nt)null==Nt[attr]&&void 0!==e[attr]&&(Nt[attr]=e[attr]);null==Nt.cropped_x&&(Nt.cropped_x=(Nt.full_width-Nt.cropped_width)/2),null==Nt.cropped_y&&(Nt.cropped_y=(Nt.full_height-Nt.cropped_height)/2);var o=2048;if(n()){var i=document.createElement("canvas"),r=i.getContext("webgl");o=r.getParameter(r.MAX_TEXTURE_SIZE)}var a=Math.min(Nt.full_width,o),s=a/Nt.full_width;Nt.full_width=a,Nt.cropped_width*=s,Nt.cropped_x*=s,t.width=Nt.cropped_width,Nt.full_height*=s,Nt.cropped_height*=s,Nt.cropped_y*=s,t.height=Nt.cropped_height;var l=document.createElement("canvas");l.width=Nt.full_width,l.height=Nt.full_height;var r=l.getContext("2d");r.drawImage(t,Nt.cropped_x,Nt.cropped_y,Nt.cropped_width,Nt.cropped_height),u(l.toDataURL("image/jpeg"))},e.cors_anonymous&&(_t.match(/^data:image\/[a-z]+;base64/)||t.setAttribute("crossOrigin","anonymous")),t.src=_t},u=function(e){var t=new THREE.Texture,n=new THREE.ImageLoader,o=function(e){t.needsUpdate=!0,t.image=e,h(t)};n.load(e,o)},h=function(e){void 0!==xt.width&&(bt.style.width=xt.width.css),void 0!==xt.height&&(bt.style.height=xt.height.css),x(),Et=n()?new THREE.WebGLRenderer:new THREE.CanvasRenderer,Et.setSize(yt.width,yt.height),St=new THREE.Scene,zt=new THREE.PerspectiveCamera(j,yt.ratio,1,300),zt.position.set(0,0,0),St.add(zt);var t=new THREE.SphereGeometry(200,32,32),i=new THREE.MeshBasicMaterial({map:e,overdraw:!0}),r=new THREE.Mesh(t,i);r.scale.x=-1,St.add(r),kt=document.createElement("div"),kt.style.position="absolute",kt.style.zIndex=0,Ct.appendChild(kt),mt&&(gt.setStyle(vt),gt.create(),Ct.appendChild(gt.getBar())),o(window,"resize",x),ft&&(o(kt,"mousedown",k),o(document,"mousemove",T),o(kt,"mousemove",D),o(document,"mouseup",z),o(kt,"touchstart",_),o(document,"touchend",z),o(document,"touchmove",R),o(kt,"mousewheel",F),o(kt,"DOMMouseScroll",F)),o(document,"fullscreenchange",O),o(document,"mozfullscreenchange",O),o(document,"webkitfullscreenchange",O),o(document,"MSFullscreenChange",O),At.addListener(H),bt.innerHTML="",bt.appendChild(Ct);var a=Et.domElement;a.style.display="block",kt.appendChild(a),p(),rt>0&&B(rt),v(),G("ready")},p=function(){var e=new THREE.Vector3;e.setX(Math.cos(nt)*Math.sin(ot)),e.setY(Math.sin(nt)),e.setZ(Math.cos(nt)*Math.cos(ot)),zt.lookAt(e),null!==Tt?Tt.render(St,zt):Et.render(St,zt)},g=function(){Tt=new THREE.StereoEffect(Et),Tt.eyeSeparation=5,Tt.setSize(yt.width,yt.height),I(),L(),gt.mustBeHidden(),p(),G("stereo-effect",!0)},m=function(){Tt=null,Et.setSize(yt.width,yt.height),gt.mustBeHidden(!1),p(),G("stereo-effect",!1)};this.toggleStereo=function(){null!==Tt?m():g()};var v=function(){lt!==!1&&(Bt=setTimeout(y,lt))},f=function(){nt-=(nt-ht)*ut,ot+=dt;var e=!0;Q||(ot=i(ot,et,tt),(ot==et||ot==tt)&&(ct?dt*=-1:(b(),e=!1))),ot=a(ot,!0),p(),e&&(Ft=setTimeout(f,st))},y=function(){f(),G("autorotate",!0)},b=function(){clearTimeout(Bt),Bt=null,clearTimeout(Ft),Ft=null,G("autorotate",!1)};this.toggleAutorotate=function(){clearTimeout(Bt),Ft?b():y()};var x=function(){(bt.clientWidth!=yt.width||bt.clientHeight!=yt.height)&&w({width:bt.clientWidth,height:bt.clientHeight})};this.fitToContainer=function(){x()};var w=function(e){yt.width=void 0!==e.width?parseInt(e.width):yt.width,yt.height=void 0!==e.height?parseInt(e.height):yt.height,yt.ratio=yt.width/yt.height,zt&&(zt.aspect=yt.ratio,zt.updateProjectionMatrix()),Et&&(Et.setSize(yt.width,yt.height),p()),Tt&&(Tt.setSize(yt.width,yt.height),p())};this.getPosition=function(){return{longitude:ot,latitude:nt}},this.getPositionInDegrees=function(){return{longitude:180*ot/Math.PI,latitude:180*nt/Math.PI}};var C=function(e,t){var n=W(e);Q||(n=i(n,et,tt));var o=W(t);o>Math.PI&&(o-=2*Math.PI),o=i(o,K,U),ot=n,nt=o,p()};this.moveTo=function(e,t){C(e,t)};var k=function(e){E(parseInt(e.clientX),parseInt(e.clientY))},_=function(e){if(1==e.touches.length){var t=e.touches[0];t.target.parentNode==kt&&E(parseInt(t.clientX),parseInt(t.clientY))}else 2==e.touches.length&&(z(),e.touches[0].target.parentNode==kt&&e.touches[1].target.parentNode==kt&&S(r(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY)));D()},E=function(e,t){Pt=e,It=t,b(),Rt=!0},S=function(e){Ht=e,Mt=!0},z=function(){Rt=!1,Mt=!1},T=function(e){e.preventDefault(),P(parseInt(e.clientX),parseInt(e.clientY))},R=function(e){if(1==e.touches.length&&Rt){var t=e.touches[0];t.target.parentNode==kt&&(e.preventDefault(),P(parseInt(t.clientX),parseInt(t.clientY)))}else if(2==e.touches.length&&e.touches[0].target.parentNode==kt&&e.touches[1].target.parentNode==kt&&Mt){e.preventDefault();var n=r(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY),o=n-Ht;if(0!=o){var i=o/Math.abs(o);B(rt+i),Ht=n}}},P=function(e,t){Rt&&(ot+=(e-Pt)*q,Q||(ot=i(ot,et,tt)),ot=a(ot,!0),nt+=(t-It)*V,nt=i(nt,K,U),Pt=e,It=t,p())},I=function(){At.start(),b(),G("device-orientation",!0)},M=function(){At.stop(),G("device-orientation",!1)};this.toggleDeviceOrientation=function(){At.isEventAttached()?M():I()};var H=function(e){ot=i(e.longitude,et,tt),nt=i(e.latitude,K,U),p()},F=function(e){e.preventDefault(),e.stopPropagation();var t=e.detail?-e.detail:e.wheelDelta;if(0!=t){var n=parseInt(t/Math.abs(t));B(rt+n)}},B=function(e){rt=i(parseInt(Math.round(e)),0,100),zt.fov=j+rt/100*(Y-j),zt.updateProjectionMatrix(),p(),G("zoom-updated",rt)};this.zoom=function(e){B(e)},this.zoomIn=function(){100>rt&&B(rt+1)},this.zoomOut=function(){rt>0&&B(rt-1)};var A=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},O=function(){document.webkitFullscreenElement||document.msFullscreenElement?(wt.width=bt.style.width,wt.height=bt.style.height,bt.style.width="100%",bt.style.height="100%",x()):(bt.webkitRequestFullscreen||bt.msRequestFullscreen)&&(bt.style.width=wt.width,bt.style.height=wt.height,x()),G("fullscreen-mode",A())},L=function(){bt.requestFullscreen?bt.requestFullscreen():bt.mozRequestFullScreen?bt.mozRequestFullScreen():bt.webkitRequestFullscreen?bt.webkitRequestFullscreen():bt.msRequestFullscreen&&bt.msRequestFullscreen()},N=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};this.toggleFullscreen=function(){A()?N():L()};var D=function(){mt&&gt.show()},X=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();n.match(/(pm|per minute)$/)&&(t/=60);var o=0;switch(n){case"rpm":case"rev per minute":case"revolutions per minute":case"rps":case"rev per second":case"revolutions per second":o=2*t*Math.PI;break;case"dpm":case"deg per minute":case"degrees per minute":case"dps":case"deg per second":case"degrees per second":o=t*Math.PI/180;break;case"rad per minute":case"radians per minute":case"rad per second":case"radians per second":o=t;break;default:m_anim=!1}return o*st/1e3},W=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();return"deg"==n&&(t*=Math.PI/180),a(t)},$=function(e){for(dim in e)if("width"==dim||"height"==dim){var t=e[dim].toString().trim(),n=parseFloat(t.replace(/^([0-9]+(?:\.[0-9]*)?).*$/,"$1")),o=t.replace(/^[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();"%"!=o&&(o="px"),xt[dim]={css:n+o,unit:o}}};this.addAction=function(e,t){e in Ot||(Ot[e]=[]),Ot[e].push(t)};var G=function(e,t){if(e in Ot&&Ot[e].length)for(var n=0,o=Ot[e].length;o>n;++n)void 0!==t?Ot[e][n](t):Ot[e][n]()};if(void 0===e||void 0===e.panorama||void 0===e.container)return void console.log("PhotoSphereViewer: no value given for panorama or container");var q=void 0!==e.long_offset?parseFloat(e.long_offset):Math.PI/360,V=void 0!==e.lat_offset?parseFloat(e.lat_offset):Math.PI/180,Y=void 0!==e.min_fov?i(parseFloat(e.min_fov),1,179):30,j=void 0!==e.max_fov?i(parseFloat(e.max_fov),1,179):90,U=void 0!==e.tilt_up_max?i(W(e.tilt_up_max),0,Math.PI/2):Math.PI/2,K=void 0!==e.tilt_down_max?-i(W(e.tilt_down_max),0,Math.PI/2):-Math.PI/2,Z=void 0!==e.min_longitude?W(e.min_longitude):0,J=void 0!==e.max_longitude?W(e.max_longitude):0,Q=Z==J;Q?(Z=0,J=2*Math.PI):0==J&&(J=2*Math.PI);var et,tt;J>Z?(et=Z,tt=J):(et=J,tt=Z);var nt=0,ot=et;if(void 0!==e.default_position){if(void 0!==e.default_position.lat){var it=W(e.default_position.lat);it>Math.PI&&(it-=2*Math.PI),nt=i(it,K,U)}void 0!==e.default_position["long"]&&(ot=i(W(e.default_position["long"]),et,tt))}var rt=0;void 0!==e.zoom_level&&(rt=i(parseInt(Math.round(e.zoom_level)),0,100));var at=60,st=1e3/at,lt=2e3;void 0!==e.time_anim&&(lt="number"==typeof e.time_anim&&e.time_anim>=0?e.time_anim:!1);var dt=X(void 0!==e.anim_speed?e.anim_speed:"2rpm"),ct=!0;void 0!==e.reverse_anim&&(ct=!!e.reverse_anim);var ut=X(void 0!==e.vertical_anim_speed?e.vertical_anim_speed:"2rpm"),ht=0;if(void 0!==e.vertical_anim_target){var pt=W(e.vertical_anim_target);pt>Math.PI&&(pt-=2*Math.PI),ht=i(pt,K,U)}var gt=new PSVNavBar(this),mt=void 0!==e.navbar?!!e.navbar:!1,vt=void 0!==e.navbar_style?e.navbar_style:{},ft=void 0!==e.allow_user_interactions?!!e.allow_user_interactions:!0;ft||(mt=!1);var yt,bt=e.container,xt={},wt={};void 0!==e.size&&$(e.size);var Ct,kt,_t=e.panorama,Et=null,St=null,zt=null,Tt=null,Rt=!1,Pt=0,It=0,Mt=!1,Ht=0,Ft=null,Bt=null,At=new Sphoords,Ot={},Lt=void 0!==e.usexmpdata?!!e.usexmpdata:!0,Nt={full_width:null,full_height:null,cropped_width:null,cropped_height:null,cropped_x:null,cropped_y:null};if(void 0!==e.pano_size){for(attr in Nt)void 0!==e.pano_size[attr]&&(Nt[attr]=parseInt(e.pano_size[attr]));Lt=!1}var Dt=void 0!==e.loading_msg?e.loading_msg.toString():"Loadingâ€¦",Xt=void 0!==e.loading_img?e.loading_img.toString():null,Wt=void 0!==e.loading_html?e.loading_html:null;void 0!==e.onready&&this.addAction("ready",e.onready);var $t=void 0!==e.autoload?!!e.autoload:!0;$t&&this.load()},PSVNavBar=function(e){var t=function(e,t){for(var n=0,o=t.length;o>n;++n)if(t[n]==e)return!0;return!1},n=function(e,n){return t(e,h)&&"string"==typeof n&&("transparent"==n||!!n.match(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/)||!!n.match(/^rgb\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(,\s*(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}\)$/)||!!n.match(/^rgba\(((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),\s*){3}(0(\.[0-9]*)?|1)\)$/))||t(e,p)&&!isNaN(parseFloat(n))&&isFinite(n)&&n>=0};this.setStyle=function(e){for(property in e)property in u&&n(property,e[property])&&(u[property]=e[property])},this.create=function(){r=document.createElement("div"),r.style.backgroundColor=u.backgroundColor,r.style.position="absolute",r.style.zIndex=10,r.style.bottom=0,r.style.width="100%",r.style.boxSizing="content-box",r.style.transition="bottom 0.4s ease-out",a=new PSVNavBarButton(e,"autorotate",u),r.appendChild(a.getButton()),s=new PSVNavBarButton(e,"zoom",u),r.appendChild(s.getButton()),l=new PSVNavBarButton(e,"fullscreen",u),r.appendChild(l.getButton()),Sphoords.isDeviceOrientationSupported&&(d=new PSVNavBarButton(e,"orientation",u),r.appendChild(d.getButton()),c=new PSVNavBarButton(e,"virtual-reality",u),r.appendChild(c.getButton()))},this.getBar=function(){return r};var o=function(){g&&(clearTimeout(g),!m&&v&&(g=setTimeout(i,5e3))),m&&(r.style.bottom=0,m=!1,v&&(g=setTimeout(i,5e3)))};this.show=function(){o()};var i=function(){m||(r.style.bottom=-r.offsetHeight+1+"px",m=!0)};this.hide=function(){i()},this.isHidden=function(){return m},this.mustBeHidden=function(e){v=void 0!==e?!!e:!0,v?i():o()};var r,a,s,l,d,c,u={backgroundColor:"rgba(61, 61, 61, 0.5)",buttonsColor:"rgba(255, 255, 255, 0.7)",buttonsBackgroundColor:"transparent",activeButtonsBackgroundColor:"rgba(255, 255, 255, 0.1)",buttonsHeight:20,autorotateThickness:1,zoomRangeWidth:50,zoomRangeThickness:1,zoomRangeDisk:7,fullscreenRatio:4/3,fullscreenThickness:2,gyroscopeThickness:1,virtualRealityRatio:4/3,virtualRealityBorderRadius:2},h=["backgroundColor","buttonsColor","buttonsBackgroundColor","activeButtonsBackgroundColor"],p=["buttonsHeight","autorotateThickness","zoomRangeWidth","zoomRangeThickness","zoomRangeDisk","fullscreenRatio","fullscreenThickness"],g=null,m=!1,v=!1},PSVNavBarButton=function(e,t,n){var o=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},i=function(){switch(t){case"autorotate":var i=n.buttonsHeight-2*n.autorotateThickness,p=i/10;l=document.createElement("div"),l.style.cssFloat="left",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=n.buttonsHeight+"px",l.style.height=n.buttonsHeight+"px",l.style.backgroundColor=n.buttonsBackgroundColor,l.style.position="relative",l.style.cursor="pointer",o(l,"click",function(){e.toggleAutorotate()});var f=document.createElement("div");f.style.boxSizing="inherit",f.style.width=i+"px",f.style.height=i+"px",f.style.borderRadius="50%",f.style.border=n.autorotateThickness+"px solid "+n.buttonsColor,l.appendChild(f);var y=document.createElement("div");y.style.boxSizing="inherit",y.style.width=i+"px",y.style.height=p+"px",y.style.borderRadius="50%",y.style.border=n.autorotateThickness+"px solid "+n.buttonsColor,y.style.position="absolute",y.style.top="50%",y.style.marginTop=-(p/2+n.autorotateThickness)+"px",l.appendChild(y),e.addAction("autorotate",d);break;case"zoom":l=document.createElement("div"),l.style.cssFloat="left",l.style.boxSizing="inherit";var b=document.createElement("div");b.style.cssFloat="left",b.style.boxSizing="inherit",b.style.padding="10px",b.style.height=n.buttonsHeight+"px",b.style.backgroundColor=n.buttonsBackgroundColor,b.style.lineHeight=n.buttonsHeight+"px",b.style.color=n.buttonsColor,b.style.cursor="pointer",b.textContent="-",o(b,"click",function(){e.zoomOut()}),l.appendChild(b),r=document.createElement("div"),r.style.cssFloat="left",r.style.boxSizing="inherit",r.style.padding=10+(n.buttonsHeight-n.zoomRangeThickness)/2+"px 5px",r.style.backgroundColor=n.buttonsBackgroundColor,r.style.cursor="pointer",l.appendChild(r),a=document.createElement("div"),a.style.boxSizing="inherit",a.style.width=n.zoomRangeWidth+"px",a.style.height=n.zoomRangeThickness+"px",a.style.backgroundColor=n.buttonsColor,a.style.position="relative",r.appendChild(a),s=document.createElement("div"),s.style.position="absolute",s.style.top=(n.zoomRangeThickness-n.zoomRangeDisk)/2+"px",s.style.left=-(n.zoomRangeDisk/2)+"px",s.style.boxSizing="inherit",s.style.width=n.zoomRangeDisk+"px",s.style.height=n.zoomRangeDisk+"px",s.style.borderRadius="50%",s.style.backgroundColor=n.buttonsColor,e.addAction("zoom-updated",c),o(r,"mousedown",u),o(r,"touchstart",h),o(document,"mousemove",m),o(document,"touchmove",v),o(document,"mouseup",g),o(document,"touchend",g),a.appendChild(s);var x=document.createElement("div");x.style.cssFloat="left",x.style.boxSizing="inherit",x.style.padding="10px",x.style.height=n.buttonsHeight+"px",x.style.backgroundColor=n.buttonsBackgroundColor,x.style.lineHeight=n.buttonsHeight+"px",x.style.color=n.buttonsColor,x.style.cursor="pointer",x.textContent="+",o(x,"click",function(){e.zoomIn()}),l.appendChild(x);break;case"fullscreen":var w=n.buttonsHeight*n.fullscreenRatio,C=.3*n.buttonsHeight,k=(n.buttonsHeight-C)/2,_=.3*w,E=(w-_)/2-n.fullscreenThickness,S=n.buttonsHeight-2*n.fullscreenThickness;l=document.createElement("div"),l.style.cssFloat="right",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=w+"px",l.style.height=n.buttonsHeight+"px",l.style.backgroundColor=n.buttonsBackgroundColor,l.style.cursor="pointer",o(l,"click",function(){e.toggleFullscreen()});var z=document.createElement("div");z.style.cssFloat="left",z.style.boxSizing="inherit",z.style.width=n.fullscreenThickness+"px",z.style.height=C+"px",z.style.borderStyle="solid",z.style.borderColor=n.buttonsColor+" transparent",z.style.borderWidth=k+"px 0",l.appendChild(z);var T=document.createElement("div");T.style.cssFloat="left",T.style.boxSizing="inherit",T.style.width=E+"px",T.style.height=S+"px",T.style.borderStyle="solid",T.style.borderColor=n.buttonsColor+" transparent",T.style.borderWidth=n.fullscreenThickness+"px 0",l.appendChild(T);var R=document.createElement("div");R.style.cssFloat="left",R.style.boxSizing="inherit",R.style.marginLeft=_+"px",R.style.width=E+"px",R.style.height=S+"px",R.style.borderStyle="solid",R.style.borderColor=n.buttonsColor+" transparent",R.style.borderWidth=n.fullscreenThickness+"px 0",l.appendChild(R);var P=document.createElement("div");P.style.cssFloat="left",P.style.boxSizing="inherit",P.style.width=n.fullscreenThickness+"px",P.style.height=C+"px",P.style.borderStyle="solid",P.style.borderColor=n.buttonsColor+" transparent",P.style.borderWidth=k+"px 0",l.appendChild(P);var I=document.createElement("div");I.style.clear="left",l.appendChild(I),e.addAction("fullscreen-mode",d);break;case"orientation":var M=n.buttonsHeight-2*n.gyroscopeThickness,H=M-4*n.gyroscopeThickness,F=M/10;l=document.createElement("div"),l.style.cssFloat="right",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=n.buttonsHeight+"px",l.style.height=n.buttonsHeight+"px",l.style.backgroundColor=n.buttonsBackgroundColor,l.style.position="relative",l.style.cursor="pointer",o(l,"click",function(){e.toggleDeviceOrientation()});var B=document.createElement("div");B.style.boxSizing="inherit",B.style.width=M+"px",B.style.height=M+"px",B.style.borderRadius="50%",B.style.border=n.gyroscopeThickness+"px solid "+n.buttonsColor,l.appendChild(B);var A=document.createElement("div");A.style.boxSizing="inherit",A.style.width=H+"px",A.style.height=F+"px",A.style.borderRadius="50%",A.style.border=n.gyroscopeThickness+"px solid "+n.buttonsColor,A.style.position="absolute",A.style.top="50%",A.style.left="50%",A.style.marginTop=-(F/2+n.gyroscopeThickness)+"px",A.style.marginLeft=-(H/2+n.gyroscopeThickness)+"px",l.appendChild(A);var O=document.createElement("div");O.style.boxSizing="inherit",O.style.width=F+"px",O.style.height=H+"px",O.style.borderRadius="50%",O.style.border=n.gyroscopeThickness+"px solid "+n.buttonsColor,O.style.position="absolute",O.style.top="50%",O.style.left="50%",O.style.marginTop=-(H/2+n.gyroscopeThickness)+"px",O.style.marginLeft=-(F/2+n.gyroscopeThickness)+"px",l.appendChild(O),e.addAction("device-orientation",d);break;case"virtual-reality":var L=n.buttonsHeight*n.virtualRealityRatio,N=L/4,D=N/2;l=document.createElement("div"),l.style.cssFloat="right",l.style.position="relative",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=L+"px",l.style.height=n.buttonsHeight+"px",l.style.backgroundColor=n.buttonsBackgroundColor,l.style.cursor="pointer",o(l,"click",function(){e.toggleStereo()});var X=document.createElement("div");X.style.boxSizing="inherit",X.style.width=L+"px",X.style.height=n.buttonsHeight+"px",X.style.borderRadius=n.virtualRealityBorderRadius+"px",X.style.backgroundColor=n.buttonsColor,l.appendChild(X);var W=document.createElement("div");W.style.boxSizing="inherit",W.style.width=N+"px",W.style.height=N+"px",W.style.position="absolute",W.style.top=D+10+"px",W.style.left=D+10+"px",W.style.borderRadius="50%",W.style.backgroundColor=n.backgroundColor,l.appendChild(W);var $=document.createElement("div");$.style.boxSizing="inherit",$.style.width=N+"px",$.style.height=N+"px",$.style.position="absolute",$.style.top=D+10+"px",$.style.right=D+10+"px",$.style.borderRadius="50%",$.style.backgroundColor=n.backgroundColor,l.appendChild($);var G=document.createElement("div");G.style.boxSizing="inherit",G.style.width=N+"px",G.style.height=n.buttonsHeight/2+"px",G.style.position="absolute",G.style.left="50%",G.style.bottom="10px",G.style.marginLeft=-(N/2)+"px",G.style.borderTopLeftRadius="50% 60%",G.style.borderTopRightRadius="50% 60%",G.style.backgroundColor=n.backgroundColor,l.appendChild(G),e.addAction("stereo-effect",d)}};this.getButton=function(){return l};var r,a,s,l,d=function(e){l.style.backgroundColor=e?n.activeButtonsBackgroundColor:n.buttonsBackgroundColor},c=function(e){s.style.left=e/100*n.zoomRangeWidth-n.zoomRangeDisk/2+"px"},u=function(e){p(parseInt(e.clientX))},h=function(e){var t=e.touches[0];(t.target==r||t.target==a||t.target==s)&&p(parseInt(t.clientX))},p=function(e){y=!0,f(e)},g=function(){y=!1},m=function(e){e.preventDefault(),f(parseInt(e.clientX))},v=function(e){var t=e.touches[0];(t.target==r||t.target==a||t.target==s)&&(e.preventDefault(),f(parseInt(t.clientX)))},f=function(t){if(y){var o=t-a.getBoundingClientRect().left,i=o/n.zoomRangeWidth*100;e.zoom(i)}},y=!1;i()},Sphoords=function(){var e=function(){var e=navigator.userAgent;return/Gecko\/[0-9.]+/.test(e)?"Gecko":/Chrome\/[0-9.]+/.test(e)?"Blink":/AppleWebKit\/[0-9.]+/.test(e)?"WebKit":/Trident\/[0-9.]+/.test(e)?"Trident":/Opera\/[0-9.]+/.test(e)?"Presto":"Gecko"},t=function(e){return e-360*Math.floor(e/360)};this.start=function(){return Sphoords.isDeviceOrientationSupported?(window.addEventListener("deviceorientation",n,!1),i=!0,!0):(console.log("Device Orientation API not supported"),!1)},this.stop=function(){i&&(window.removeEventListener("deviceorientation",n,!1),i=!1)},this.toggle=function(){i?this.stop():this.start()},this.isEventAttached=function(){return i};var n=function(e){c=Sphoords.getScreenOrientation();var n=0,i=0;switch(c){case"portrait-primary":n=e.alpha+e.gamma,i=e.beta-90;break;case"landscape-primary":if(n=e.alpha+e.beta-90,i=-e.gamma-90,Math.abs(e.beta)>90)switch(u){case"Blink":i+=180;break;case"Gecko":default:i=-i}break;case"landscape-secondary":if(n=e.alpha-e.beta+90,i=e.gamma-90,Math.abs(e.beta)>90)switch(u){case"Blink":i+=180;break;case"Gecko":default:i=-i}break;case"portrait-secondary":n=e.alpha-e.gamma,i=180-(e.beta-90),i=270-e.beta}i=t(i),i>=180&&(i-=360),r=t(n),a=Math.max(-90,Math.min(90,i)),s=r*d,l=a*d,o()};this.getCoordinates=function(){return{longitude:s,latitude:l}},this.getCoordinatesInDegrees=function(){return{longitude:r,latitude:a}},this.getScreenOrientation=function(){return c},this.addListener=function(e){h.push(e)};var o=function(){if(h.length)for(var e=0,t=h.length;t>e;++e)h[e]({longitude:s,latitude:l})},i=!1,r=0,a=0,s=0,l=0,d=Math.PI/180,c=Sphoords.getScreenOrientation(),u=e(),h=[]};Sphoords.getScreenOrientation=function(){var e=null;return screen.orientation?e=screen.orientation:screen.mozOrientation?e=screen.mozOrientation:screen.msOrientation&&(e=screen.msOrientation),null!==e&&"object"==typeof e?e.type:e},Sphoords.isDeviceOrientationSupported=!1,function(){function e(t){null!==t&&null!==t.alpha&&(Sphoords.isDeviceOrientationSupported=!0,window.removeEventListener("deviceorientation",e))}window.DeviceOrientationEvent&&null!==Sphoords.getScreenOrientation()&&window.addEventListener("deviceorientation",e)}();