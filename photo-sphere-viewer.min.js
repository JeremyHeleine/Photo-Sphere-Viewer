var PhotoSphereViewer=function(e){var t=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},o=function(){var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl"))},n=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)},i=function(e,t,o){return Math.max(t,Math.min(o,e))},r=function(e,t,o,n){var i=o-e,r=n-t;return i*i+r*r},a=function(e,t){return t=void 0!==t?!!t:!1,t&&e==2*Math.PI?2*Math.PI:e-2*Math.floor(e/(2*Math.PI))*Math.PI};this.load=function(){if(we.innerHTML="",Ye&&1===Ye.nodeType)we.appendChild(Ye);else if(Ye&&"string"==typeof Ye)we.innerHTML=Ye;else if(Ge){var e=document.createElement("img");e.setAttribute("src",Ge),e.setAttribute("alt",Ve),we.appendChild(e)}else we.textContent=Ve;return ke=document.createElement("div"),ke.style.width="100%",ke.style.height="100%",ke.style.position="relative",ke.style.overflow="hidden",t()?void 0===window.THREE?void console.log("PhotoSphereViewer: Three.js is not loaded."):(ye={width:0,height:0,ratio:0},void(Xe&&!Se.match(/^data:image\/[a-z]+;base64/)?d():c())):void(we.textContent="Canvas is not supported, update your browser!")};var s=function(e){for(var t=0,o=0,n="";-1!=(t=e.indexOf("<x:xmpmeta",o))&&-1!=(o=e.indexOf("</x:xmpmeta>",t));)if(n=e.substring(t,o),-1!=n.indexOf("GPano:"))return n;return""},l=function(e,t){var o=e.indexOf("GPano:"+t)+t.length+8,n=e.indexOf('"',o);return e.substring(o,n)},d=function(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window.ActiveXObject)return void(we.textContent="XHR is not supported, update your browser!");try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}}e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=s(e.responseText);if(!t.length)return void c();Ne={full_width:parseInt(l(t,"FullPanoWidthPixels")),full_height:parseInt(l(t,"FullPanoHeightPixels")),cropped_width:parseInt(l(t,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(l(t,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(l(t,"CroppedAreaLeftPixels")),cropped_y:parseInt(l(t,"CroppedAreaTopPixels"))},qe=!0,c()}},e.open("GET",Se,!0),e.send(null)},c=function(){var e=new Image;e.onload=function(){var t={full_width:e.width,full_height:e.height,cropped_width:e.width,cropped_height:e.height,cropped_x:null,cropped_y:null};for(var n in Ne)null===Ne[n]&&void 0!==t[n]&&(Ne[n]=t[n]);if(qe){if(Ne.cropped_width!=t.cropped_width){var i=t.cropped_width/Ne.cropped_width;Ne.cropped_width=t.cropped_width,Ne.full_width*=i,Ne.cropped_x*=i}if(Ne.cropped_height!=t.cropped_height){var r=t.cropped_height/Ne.cropped_height;Ne.cropped_height=t.cropped_height,Ne.full_height*=r,Ne.cropped_y*=r}}null===Ne.cropped_x&&(Ne.cropped_x=(Ne.full_width-Ne.cropped_width)/2),null===Ne.cropped_y&&(Ne.cropped_y=(Ne.full_height-Ne.cropped_height)/2);var a=2048;if(o()){var s=document.createElement("canvas"),l=s.getContext("webgl");a=l.getParameter(l.MAX_TEXTURE_SIZE)}var d=Math.min(Ne.full_width,a),c=d/Ne.full_width;Ne.full_width=d,Ne.cropped_width*=c,Ne.cropped_x*=c,e.width=Ne.cropped_width,Ne.full_height*=c,Ne.cropped_height*=c,Ne.cropped_y*=c,e.height=Ne.cropped_height;var h=document.createElement("canvas");h.width=Ne.full_width,h.height=Ne.full_height;var p=h.getContext("2d");p.drawImage(e,Ne.cropped_x,Ne.cropped_y,Ne.cropped_width,Ne.cropped_height),u(h.toDataURL("image/jpeg"))},We&&!Se.match(/^data:image\/[a-z]+;base64/)&&e.setAttribute("crossOrigin","anonymous"),e.src=Se},u=function(e){var t=new THREE.Texture,o=new THREE.ImageLoader,n=function(e){t.needsUpdate=!0,t.image=e,h(t)};o.load(e,n)},h=function(e){void 0!==_e.width&&(we.style.width=_e.width.css),void 0!==_e.height&&(we.style.height=_e.height.css),x(),ze=o()?new THREE.WebGLRenderer:new THREE.CanvasRenderer,ze.setSize(ye.width,ye.height),Te=new THREE.Scene,Re=new THREE.PerspectiveCamera(j,ye.ratio,1,300),Re.position.set(0,0,0),Te.add(Re);var t=new THREE.SphereGeometry(200,32,32),i=new THREE.MeshBasicMaterial({map:e,overdraw:!0}),r=new THREE.Mesh(t,i);r.scale.x=-1,Te.add(r),Ee=document.createElement("div"),Ee.style.position="absolute",Ee.style.zIndex=0,ke.appendChild(Ee),me&&(ge.setStyle(ve),ge.create(),ke.appendChild(ge.getBar())),n(window,"resize",x),fe&&(n(Ee,"mousedown",C),n(document,"mousemove",T),n(Ee,"mousemove",X),n(document,"mouseup",z),n(Ee,"touchstart",k),n(document,"touchend",z),n(document,"touchmove",R),be&&(n(Ee,"mousewheel",F),n(Ee,"DOMMouseScroll",F))),n(document,"fullscreenchange",L),n(document,"mozfullscreenchange",L),n(document,"webkitfullscreenchange",L),n(document,"MSFullscreenChange",L),Ae.addListener(H),we.innerHTML="",we.appendChild(ke);var a=ze.domElement;a.style.display="block",Ee.appendChild(a),p(),re>0&&B(re),v(),q("ready")},p=function(){var e=new THREE.Vector3;e.setX(Math.cos(oe)*Math.sin(ne)),e.setY(Math.sin(oe)),e.setZ(Math.cos(oe)*Math.cos(ne)),Re.lookAt(e),null!==Ie?Ie.render(Te,Re):ze.render(Te,Re)},g=function(){Ie=new THREE.StereoEffect(ze),Ie.eyeSeparation=xe,Ie.setSize(ye.width,ye.height),M(),A(),ge.mustBeHidden(),p(),q("stereo-effect",!0)},m=function(){Ie=null,ze.setSize(ye.width,ye.height),ge.mustBeHidden(!1),p(),q("stereo-effect",!1)};this.toggleStereo=function(){null!==Ie?m():g()};var v=function(){le!==!1&&(Le=setTimeout(y,le))},f=function(){oe-=(oe-he)*ue,ne+=de;var e=!0;Q||(ne=i(ne,ee,te),(ne==ee||ne==te)&&(ce?de*=-1:(b(),e=!1))),ne=a(ne,!0),q("position-updated",{longitude:ne,latitude:oe}),p(),e&&(Oe=setTimeout(f,se))},y=function(){f(),q("autorotate",!0)},b=function(){clearTimeout(Le),Le=null,clearTimeout(Oe),Oe=null,q("autorotate",!1)};this.toggleAutorotate=function(){clearTimeout(Le),Oe?b():y()};var x=function(){(we.clientWidth!=ye.width||we.clientHeight!=ye.height)&&w({width:we.clientWidth,height:we.clientHeight})};this.fitToContainer=function(){x()};var w=function(e){ye.width=void 0!==e.width?parseInt(e.width):ye.width,ye.height=void 0!==e.height?parseInt(e.height):ye.height,ye.ratio=ye.width/ye.height,Re&&(Re.aspect=ye.ratio,Re.updateProjectionMatrix()),ze&&(ze.setSize(ye.width,ye.height),p()),Ie&&(Ie.setSize(ye.width,ye.height),p())};this.getPosition=function(){return{longitude:ne,latitude:oe}},this.getPositionInDegrees=function(){return{longitude:180*ne/Math.PI,latitude:180*oe/Math.PI}};var _=function(e,t){var o=N(e);Q||(o=i(o,ee,te));var n=N(t);n>Math.PI&&(n-=2*Math.PI),n=i(n,Z,U),ne=o,oe=n,q("position-updated",{longitude:ne,latitude:oe}),p()};this.moveTo=function(e,t){_(e,t)};var C=function(e){E(parseInt(e.clientX),parseInt(e.clientY))},k=function(e){if(1==e.touches.length){var t=e.touches[0];t.target.parentNode==Ee&&E(parseInt(t.clientX),parseInt(t.clientY))}else 2==e.touches.length&&(z(),e.touches[0].target.parentNode==Ee&&e.touches[1].target.parentNode==Ee&&S(r(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY)));X()},E=function(e,t){Pe=e,He=t,b(),Me=!0},S=function(e){Be=e,Fe=!0},z=function(e){Me=!1,Fe=!1},T=function(e){e.preventDefault(),I(parseInt(e.clientX),parseInt(e.clientY))},R=function(e){if(1==e.touches.length&&Me){var t=e.touches[0];t.target.parentNode==Ee&&(e.preventDefault(),I(parseInt(t.clientX),parseInt(t.clientY)))}else if(2==e.touches.length&&e.touches[0].target.parentNode==Ee&&e.touches[1].target.parentNode==Ee&&Fe){e.preventDefault();var o=r(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY),n=o-Be;if(0!==n){var i=n/Math.abs(n);B(re+i),Be=o}}},I=function(e,t){Me&&(ne+=(e-Pe)*V,Q||(ne=i(ne,ee,te)),ne=a(ne,!0),oe+=(t-He)*G,oe=i(oe,Z,U),Pe=e,He=t,q("position-updated",{longitude:ne,latitude:oe}),p())},M=function(){Ae.start(),b(),q("device-orientation",!0)},P=function(){Ae.stop(),q("device-orientation",!1)};this.toggleDeviceOrientation=function(){Ae.isEventAttached()?P():M()};var H=function(e){ne=i(e.longitude,ee,te),oe=i(e.latitude,Z,U),q("position-updated",{longitude:ne,latitude:oe}),p()},F=function(e){e.preventDefault(),e.stopPropagation();var t=e.detail?-e.detail:e.wheelDelta;if(0!==t){var o=parseInt(t/Math.abs(t));B(re+o)}},B=function(e){re=i(parseInt(Math.round(e)),0,100),Re.fov=j+re/100*(Y-j),Re.updateProjectionMatrix(),p(),q("zoom-updated",re)};this.getZoomLevel=function(){return re},this.zoom=function(e){B(e)},this.zoomIn=function(){100>re&&B(re+1)},this.zoomOut=function(){re>0&&B(re-1)};var O=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},L=function(){document.webkitFullscreenElement||document.msFullscreenElement?(Ce.width=we.style.width,Ce.height=we.style.height,we.style.width="100%",we.style.height="100%",x()):(we.webkitRequestFullscreen||we.msRequestFullscreen)&&(we.style.width=Ce.width,we.style.height=Ce.height,x()),q("fullscreen-mode",O())},A=function(){we.requestFullscreen?we.requestFullscreen():we.mozRequestFullScreen?we.mozRequestFullScreen():we.webkitRequestFullscreen?we.webkitRequestFullscreen():we.msRequestFullscreen&&we.msRequestFullscreen()},D=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};this.toggleFullscreen=function(){O()?D():A()};var X=function(){me&&ge.show()},W=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),o=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();o.match(/(pm|per minute)$/)&&(t/=60);var n=0;switch(o){case"rpm":case"rev per minute":case"revolutions per minute":case"rps":case"rev per second":case"revolutions per second":n=2*t*Math.PI;break;case"dpm":case"deg per minute":case"degrees per minute":case"dps":case"deg per second":case"degrees per second":n=t*Math.PI/180;break;case"rad per minute":case"radians per minute":case"rad per second":case"radians per second":n=t;break;default:m_anim=!1}return n*se/1e3},N=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),o=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();return"deg"==o&&(t*=Math.PI/180),a(t)},$=function(e){for(var t in e)if("width"==t||"height"==t){var o=e[t].toString().trim(),n=parseFloat(o.replace(/^([0-9]+(?:\.[0-9]*)?).*$/,"$1")),i=o.replace(/^[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();"%"!=i&&(i="px"),_e[t]={css:n+i,unit:i}}};this.addAction=function(e,t){e in De||(De[e]=[]),De[e].push(t)};var q=function(e,t){if(e in De&&De[e].length)for(var o=0,n=De[e].length;n>o;++o)void 0!==t?De[e][o](t):De[e][o]()};if(void 0===e||void 0===e.panorama||void 0===e.container)return void console.log("PhotoSphereViewer: no value given for panorama or container");var V=void 0!==e.long_offset?N(e.long_offset):Math.PI/360,G=void 0!==e.lat_offset?N(e.lat_offset):Math.PI/180,Y=void 0!==e.min_fov?i(parseFloat(e.min_fov),1,179):30,j=void 0!==e.max_fov?i(parseFloat(e.max_fov),1,179):90,U=void 0!==e.tilt_up_max?i(N(e.tilt_up_max),0,Math.PI/2):Math.PI/2,Z=void 0!==e.tilt_down_max?-i(N(e.tilt_down_max),0,Math.PI/2):-Math.PI/2,K=void 0!==e.min_longitude?N(e.min_longitude):0,J=void 0!==e.max_longitude?N(e.max_longitude):0,Q=K==J;Q?(K=0,J=2*Math.PI):0===J&&(J=2*Math.PI);var ee,te;J>K?(ee=K,te=J):(ee=J,te=K);var oe=0,ne=ee;if(void 0!==e.default_position){if(void 0!==e.default_position.lat){var ie=N(e.default_position.lat);ie>Math.PI&&(ie-=2*Math.PI),oe=i(ie,Z,U)}void 0!==e.default_position["long"]&&(ne=i(N(e.default_position["long"]),ee,te))}var re=0;void 0!==e.zoom_level&&(re=i(parseInt(Math.round(e.zoom_level)),0,100));var ae=60,se=1e3/ae,le=2e3;void 0!==e.time_anim&&(le="number"==typeof e.time_anim&&e.time_anim>=0?e.time_anim:!1);var de=W(void 0!==e.anim_speed?e.anim_speed:"2rpm"),ce=!0;void 0!==e.reverse_anim&&(ce=!!e.reverse_anim);var ue=W(void 0!==e.vertical_anim_speed?e.vertical_anim_speed:"2rpm"),he=0;if(void 0!==e.vertical_anim_target){var pe=N(e.vertical_anim_target);pe>Math.PI&&(pe-=2*Math.PI),he=i(pe,Z,U)}var ge=new PSVNavBar(this),me=void 0!==e.navbar?!!e.navbar:!1,ve=void 0!==e.navbar_style?e.navbar_style:{},fe=void 0!==e.allow_user_interactions?!!e.allow_user_interactions:!0;fe||(me=!1);var ye,be=void 0!==e.allow_scroll_to_zoom?!!e.allow_scroll_to_zoom:!0,xe=void 0!==e.eyes_offset?parseFloat(e.eyes_offset):5,we="string"==typeof e.container?document.getElementById(e.container):e.container,_e={},Ce={};void 0!==e.size&&$(e.size);var ke,Ee,Se=e.panorama,ze=null,Te=null,Re=null,Ie=null,Me=!1,Pe=0,He=0,Fe=!1,Be=0,Oe=null,Le=null,Ae=new Sphoords,De={},Xe=void 0!==e.usexmpdata?!!e.usexmpdata:!0,We=void 0!==e.cors_anonymous?!!e.cors_anonymous:!0,Ne={full_width:null,full_height:null,cropped_width:null,cropped_height:null,cropped_x:null,cropped_y:null};if(void 0!==e.pano_size){for(var $e in Ne)void 0!==e.pano_size[$e]&&(Ne[$e]=parseInt(e.pano_size[$e]));Xe=!1}var qe=!1,Ve=void 0!==e.loading_msg?e.loading_msg.toString():"Loadingâ€¦",Ge=void 0!==e.loading_img?e.loading_img.toString():null,Ye=void 0!==e.loading_html?e.loading_html:null;void 0!==e.onready&&this.addAction("ready",e.onready);var je=void 0!==e.autoload?!!e.autoload:!0;je&&this.load()},PSVNavBar=function(e){var t=function(e,t){for(var o=0,n=t.length;n>o;++o)if(t[o]==e)return!0;return!1},o=function(e,o){return t(e,h)&&"string"==typeof o&&("transparent"==o||!!o.match(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/)||!!o.match(/^rgb\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(,\s*(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}\)$/)||!!o.match(/^rgba\(((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),\s*){3}(0(\.[0-9]*)?|1)\)$/))||t(e,p)&&!isNaN(parseFloat(o))&&isFinite(o)&&o>=0};this.setStyle=function(e){for(var t in e)t in u&&o(t,e[t])&&(u[t]=e[t])},this.create=function(){r=document.createElement("div"),r.style.backgroundColor=u.backgroundColor,r.style.position="absolute",r.style.zIndex=10,r.style.bottom=0,r.style.width="100%",r.style.boxSizing="content-box",r.style.transition="bottom 0.4s ease-out",a=new PSVNavBarButton(e,"autorotate",u),r.appendChild(a.getButton()),s=new PSVNavBarButton(e,"zoom",u),r.appendChild(s.getButton()),l=new PSVNavBarButton(e,"fullscreen",u),r.appendChild(l.getButton()),Sphoords.isDeviceOrientationSupported&&(d=new PSVNavBarButton(e,"orientation",u),r.appendChild(d.getButton()),c=new PSVNavBarButton(e,"virtual-reality",u),r.appendChild(c.getButton()))},this.getBar=function(){return r};var n=function(){g&&(clearTimeout(g),!m&&v&&(g=setTimeout(i,5e3))),m&&(r.style.bottom=0,m=!1,v&&(g=setTimeout(i,5e3)))};this.show=function(){n()};var i=function(){m||(r.style.bottom=-r.offsetHeight+1+"px",m=!0)};this.hide=function(){i()},this.isHidden=function(){return m},this.mustBeHidden=function(e){v=void 0!==e?!!e:!0,v?i():n()};var r,a,s,l,d,c,u={backgroundColor:"rgba(61, 61, 61, 0.5)",buttonsColor:"rgba(255, 255, 255, 0.7)",buttonsBackgroundColor:"transparent",activeButtonsBackgroundColor:"rgba(255, 255, 255, 0.1)",buttonsHeight:20,autorotateThickness:1,zoomRangeWidth:50,zoomRangeThickness:1,zoomRangeDisk:7,fullscreenRatio:4/3,fullscreenThickness:2,gyroscopeThickness:1,virtualRealityRatio:4/3,virtualRealityBorderRadius:2},h=["backgroundColor","buttonsColor","buttonsBackgroundColor","activeButtonsBackgroundColor"],p=["buttonsHeight","autorotateThickness","zoomRangeWidth","zoomRangeThickness","zoomRangeDisk","fullscreenRatio","fullscreenThickness"],g=null,m=!1,v=!1},PSVNavBarButton=function(e,t,o){var n=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)},i=function(){switch(t){case"autorotate":var i=o.buttonsHeight-2*o.autorotateThickness,p=i/10;l=document.createElement("div"),l.style.cssFloat="left",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=o.buttonsHeight+"px",l.style.height=o.buttonsHeight+"px",l.style.backgroundColor=o.buttonsBackgroundColor,l.style.position="relative",l.style.cursor="pointer",n(l,"click",function(){e.toggleAutorotate()});var f=document.createElement("div");f.style.boxSizing="inherit",f.style.width=i+"px",f.style.height=i+"px",f.style.borderRadius="50%",f.style.border=o.autorotateThickness+"px solid "+o.buttonsColor,l.appendChild(f);var y=document.createElement("div");y.style.boxSizing="inherit",y.style.width=i+"px",y.style.height=p+"px",y.style.borderRadius="50%",y.style.border=o.autorotateThickness+"px solid "+o.buttonsColor,y.style.position="absolute",y.style.top="50%",y.style.marginTop=-(p/2+o.autorotateThickness)+"px",l.appendChild(y),e.addAction("autorotate",d);break;case"zoom":l=document.createElement("div"),l.style.cssFloat="left",l.style.boxSizing="inherit";var b=document.createElement("div");b.style.cssFloat="left",b.style.boxSizing="inherit",b.style.padding="10px",b.style.height=o.buttonsHeight+"px",b.style.backgroundColor=o.buttonsBackgroundColor,b.style.lineHeight=o.buttonsHeight+"px",b.style.color=o.buttonsColor,b.style.cursor="pointer",b.textContent="-",n(b,"click",function(){e.zoomOut()}),l.appendChild(b),r=document.createElement("div"),r.style.cssFloat="left",r.style.boxSizing="inherit",r.style.padding=10+(o.buttonsHeight-o.zoomRangeThickness)/2+"px 5px",r.style.backgroundColor=o.buttonsBackgroundColor,r.style.cursor="pointer",l.appendChild(r),a=document.createElement("div"),a.style.boxSizing="inherit",a.style.width=o.zoomRangeWidth+"px",a.style.height=o.zoomRangeThickness+"px",a.style.backgroundColor=o.buttonsColor,a.style.position="relative",r.appendChild(a),s=document.createElement("div"),s.style.position="absolute",s.style.top=(o.zoomRangeThickness-o.zoomRangeDisk)/2+"px",s.style.left=-(o.zoomRangeDisk/2)+"px",s.style.boxSizing="inherit",s.style.width=o.zoomRangeDisk+"px",s.style.height=o.zoomRangeDisk+"px",s.style.borderRadius="50%",s.style.backgroundColor=o.buttonsColor,e.addAction("zoom-updated",c),n(r,"mousedown",u),n(r,"touchstart",h),n(document,"mousemove",m),n(document,"touchmove",v),n(document,"mouseup",g),n(document,"touchend",g),a.appendChild(s);var x=document.createElement("div");x.style.cssFloat="left",x.style.boxSizing="inherit",x.style.padding="10px",x.style.height=o.buttonsHeight+"px",x.style.backgroundColor=o.buttonsBackgroundColor,x.style.lineHeight=o.buttonsHeight+"px",x.style.color=o.buttonsColor,x.style.cursor="pointer",x.textContent="+",n(x,"click",function(){e.zoomIn()}),l.appendChild(x);break;case"fullscreen":var w=o.buttonsHeight*o.fullscreenRatio,_=.3*o.buttonsHeight,C=(o.buttonsHeight-_)/2,k=.3*w,E=(w-k)/2-o.fullscreenThickness,S=o.buttonsHeight-2*o.fullscreenThickness;l=document.createElement("div"),l.style.cssFloat="right",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=w+"px",l.style.height=o.buttonsHeight+"px",l.style.backgroundColor=o.buttonsBackgroundColor,l.style.cursor="pointer",n(l,"click",function(){e.toggleFullscreen()});var z=document.createElement("div");z.style.cssFloat="left",z.style.boxSizing="inherit",z.style.width=o.fullscreenThickness+"px",z.style.height=_+"px",z.style.borderStyle="solid",z.style.borderColor=o.buttonsColor+" transparent",z.style.borderWidth=C+"px 0",l.appendChild(z);var T=document.createElement("div");T.style.cssFloat="left",T.style.boxSizing="inherit",T.style.width=E+"px",T.style.height=S+"px",T.style.borderStyle="solid",T.style.borderColor=o.buttonsColor+" transparent",T.style.borderWidth=o.fullscreenThickness+"px 0",l.appendChild(T);var R=document.createElement("div");R.style.cssFloat="left",R.style.boxSizing="inherit",R.style.marginLeft=k+"px",R.style.width=E+"px",R.style.height=S+"px",R.style.borderStyle="solid",R.style.borderColor=o.buttonsColor+" transparent",R.style.borderWidth=o.fullscreenThickness+"px 0",l.appendChild(R);var I=document.createElement("div");I.style.cssFloat="left",I.style.boxSizing="inherit",I.style.width=o.fullscreenThickness+"px",I.style.height=_+"px",I.style.borderStyle="solid",I.style.borderColor=o.buttonsColor+" transparent",I.style.borderWidth=C+"px 0",l.appendChild(I);var M=document.createElement("div");M.style.clear="left",l.appendChild(M),e.addAction("fullscreen-mode",d);break;case"orientation":var P=o.buttonsHeight-2*o.gyroscopeThickness,H=P-4*o.gyroscopeThickness,F=P/10;l=document.createElement("div"),l.style.cssFloat="right",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=o.buttonsHeight+"px",l.style.height=o.buttonsHeight+"px",l.style.backgroundColor=o.buttonsBackgroundColor,l.style.position="relative",l.style.cursor="pointer",n(l,"click",function(){e.toggleDeviceOrientation()});var B=document.createElement("div");B.style.boxSizing="inherit",B.style.width=P+"px",B.style.height=P+"px",B.style.borderRadius="50%",B.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,l.appendChild(B);var O=document.createElement("div");O.style.boxSizing="inherit",O.style.width=H+"px",O.style.height=F+"px",O.style.borderRadius="50%",O.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,O.style.position="absolute",O.style.top="50%",O.style.left="50%",O.style.marginTop=-(F/2+o.gyroscopeThickness)+"px",O.style.marginLeft=-(H/2+o.gyroscopeThickness)+"px",l.appendChild(O);var L=document.createElement("div");L.style.boxSizing="inherit",L.style.width=F+"px",L.style.height=H+"px",L.style.borderRadius="50%",L.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,L.style.position="absolute",L.style.top="50%",L.style.left="50%",L.style.marginTop=-(H/2+o.gyroscopeThickness)+"px",L.style.marginLeft=-(F/2+o.gyroscopeThickness)+"px",l.appendChild(L),e.addAction("device-orientation",d);break;case"virtual-reality":var A=o.buttonsHeight*o.virtualRealityRatio,D=A/4,X=D/2;l=document.createElement("div"),l.style.cssFloat="right",l.style.position="relative",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=A+"px",l.style.height=o.buttonsHeight+"px",l.style.backgroundColor=o.buttonsBackgroundColor,l.style.cursor="pointer",n(l,"click",function(){e.toggleStereo()});var W=document.createElement("div");W.style.boxSizing="inherit",W.style.width=A+"px",W.style.height=o.buttonsHeight+"px",W.style.borderRadius=o.virtualRealityBorderRadius+"px",W.style.backgroundColor=o.buttonsColor,l.appendChild(W);var N=document.createElement("div");N.style.boxSizing="inherit",N.style.width=D+"px",N.style.height=D+"px",N.style.position="absolute",N.style.top=X+10+"px",N.style.left=X+10+"px",N.style.borderRadius="50%",N.style.backgroundColor=o.backgroundColor,l.appendChild(N);var $=document.createElement("div");$.style.boxSizing="inherit",$.style.width=D+"px",$.style.height=D+"px",$.style.position="absolute",$.style.top=X+10+"px",$.style.right=X+10+"px",$.style.borderRadius="50%",$.style.backgroundColor=o.backgroundColor,l.appendChild($);var q=document.createElement("div");q.style.boxSizing="inherit",q.style.width=D+"px",q.style.height=o.buttonsHeight/2+"px",q.style.position="absolute",q.style.left="50%",q.style.bottom="10px",q.style.marginLeft=-(D/2)+"px",q.style.borderTopLeftRadius="50% 60%",q.style.borderTopRightRadius="50% 60%",q.style.backgroundColor=o.backgroundColor,l.appendChild(q),e.addAction("stereo-effect",d)}};this.getButton=function(){return l};var r,a,s,l,d=function(e){e?l.style.backgroundColor=o.activeButtonsBackgroundColor:l.style.backgroundColor=o.buttonsBackgroundColor},c=function(e){s.style.left=e/100*o.zoomRangeWidth-o.zoomRangeDisk/2+"px"},u=function(e){p(parseInt(e.clientX))},h=function(e){var t=e.touches[0];(t.target==r||t.target==a||t.target==s)&&p(parseInt(t.clientX))},p=function(e){y=!0,f(e)},g=function(e){y=!1},m=function(e){e.preventDefault(),f(parseInt(e.clientX))},v=function(e){var t=e.touches[0];(t.target==r||t.target==a||t.target==s)&&(e.preventDefault(),f(parseInt(t.clientX)))},f=function(t){if(y){var n=t-a.getBoundingClientRect().left,i=n/o.zoomRangeWidth*100;e.zoom(i)}},y=!1;i()},Sphoords=function(){var e=function(){var e=navigator.userAgent;return/Gecko\/[0-9.]+/.test(e)?"Gecko":/Chrome\/[0-9.]+/.test(e)?"Blink":/AppleWebKit\/[0-9.]+/.test(e)?"WebKit":/Trident\/[0-9.]+/.test(e)?"Trident":/Opera\/[0-9.]+/.test(e)?"Presto":"Gecko"},t=function(e){return e-360*Math.floor(e/360)};this.start=function(){return Sphoords.isDeviceOrientationSupported?(window.addEventListener("deviceorientation",o,!1),i=!0,!0):(console.log("Device Orientation API not supported"),!1)},this.stop=function(){i&&(window.removeEventListener("deviceorientation",o,!1),i=!1)},this.toggle=function(){i?this.stop():this.start()},this.isEventAttached=function(){return i};var o=function(e){c=Sphoords.getScreenOrientation();var o=0,i=0;switch(c){case"portrait-primary":o=e.alpha+e.gamma,i=e.beta-90;break;case"landscape-primary":if(o=e.alpha+e.beta-90,i=-e.gamma-90,Math.abs(e.beta)>90)switch(u){case"Blink":i+=180;break;case"Gecko":default:i=-i}break;case"landscape-secondary":if(o=e.alpha-e.beta+90,i=e.gamma-90,Math.abs(e.beta)>90)switch(u){case"Blink":i+=180;break;case"Gecko":default:i=-i}break;case"portrait-secondary":o=e.alpha-e.gamma,i=180-(e.beta-90),i=270-e.beta}i=t(i),i>=180&&(i-=360),r=t(o),a=Math.max(-90,Math.min(90,i)),s=r*d,l=a*d,n()};this.getCoordinates=function(){return{longitude:s,latitude:l}},this.getCoordinatesInDegrees=function(){return{longitude:r,latitude:a}},this.getScreenOrientation=function(){return c},this.addListener=function(e){h.push(e)};var n=function(){if(h.length)for(var e=0,t=h.length;t>e;++e)h[e]({longitude:s,latitude:l})},i=!1,r=0,a=0,s=0,l=0,d=Math.PI/180,c=Sphoords.getScreenOrientation(),u=e(),h=[]};Sphoords.getScreenOrientation=function(){var e=null;return screen.orientation?e=screen.orientation:screen.mozOrientation?e=screen.mozOrientation:screen.msOrientation&&(e=screen.msOrientation),null!==e&&"object"==typeof e?e.type:e},Sphoords.isDeviceOrientationSupported=!1,function(){function e(t){null!==t&&null!==t.alpha&&(Sphoords.isDeviceOrientationSupported=!0,window.removeEventListener("deviceorientation",e))}window.DeviceOrientationEvent&&null!==Sphoords.getScreenOrientation()&&window.addEventListener("deviceorientation",e)}();